<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>仿豆瓣分页</title>
<link rel="stylesheet" href="css/bootstrap.min.css">
<style>
	body{
		font:14px Helvetica,Arial,"Microsoft Yahei",sans-serif;
	}
	.clearfix:after{
		content: '.';
		display: block;
		height: 0;
		clear: both;
		visibility: hidden;
	}
	.clearfix{zoom:1;}
	ul{
		list-style-type: none;
		padding: 0;
		margin: 0;
	}
	ul li{
		float: left;
	}
	.wrap{
		width: 640px;
		overflow: hidden;
		margin: 20px auto;
		text-align: center;
	}
	.list{
		position: relative;
		width: 670px;height: 280px;
		padding: 10px;
		margin-right: -30px;
		margin-bottom: -30px;
	}
	.list li{
		position: absolute;
		top: 10px;left: 10px;
		margin:0 30px 30px 0;
		width: 100px;height: 100px;
		background-color: #f00;
	}
	#page{
		display: inline-block;
		margin: 20px auto;
	}
</style>
<script src="js/jquery.min.js"></script>
<script>
$(function(){
    /**
     * 分页组件
     */
    $.fn.doubanPage=function(options){
        var opts={
            pageSize:10,//每页记录数
            pageNum:0,//总页数，由计算得出
            total:0,//总记录数
            curr:1,//当前第几页
            show:5,//中间展示几页
            side:2,//两侧展示几页
            callback:function(curr,pageSize,pageNum,total){}//当前页，页大小，总页数，总记录数
        },container=$(this);

        $.extend(true,opts,options);
        if(!opts.total){return false;}

        function bindEvent(){
            container.off().on('click', 'li', function() {
                var className=$(this).attr('class')||'';
                if(/disabled|active/i.test(className)){
                    return false;
                }
                if(/prev/i.test(className)){
                    opts.curr--;
                } else if(/next/i.test(className)){
                    opts.curr++;
                } else {
                    opts.curr=parseInt($(this).children('a').text());
                }
                render();
            });
        }

        function render(){
            opts.pageNum=Math.ceil(opts.total/opts.pageSize);
            if(opts.pageNum<opts.show){
                opts.show=opts.pageNum;
            }
            if(opts.curr<=0){
                opts.curr=1;
            }
            if(opts.curr>opts.pageNum){
                opts.curr=opts.pageNum;
            }

            var startLen=Math.min(opts.side,Math.ceil(opts.pageNum/2)),//左侧开头展示的页数
                end=Math.min(opts.side,Math.floor(opts.pageNum/2)),//右侧结尾展示的页数
                showLeftNums=Math.ceil((opts.show-1)/2),//中间展示页数的前半部分数
                showRightNums=Math.floor((opts.show-1)/2),//中间展示页数的后半部分数
                showIndex=startLen,//中间显示页数的开始下标
                showLen=opts.pageNum-end,//中间显示页数的结束下标
                leftNum,rightNum,i,html='';

            //在左半区对showIndex和showRightNums进行调整
            leftNum=opts.curr-startLen-showLeftNums-1;//左侧被"..."代替的页数
            if(leftNum>0){
                showIndex+=leftNum;
            } else {
                showRightNums-=leftNum;
            }
            
            //在右半区对showIndex和showLen进行调整
            rightNum=showLen-showRightNums-opts.curr;//右侧被"..."代替的页数
            if(rightNum>0){
                showLen-=rightNum;
            } else {
                showIndex+=rightNum;
            }

            if(showIndex<=0){
            	showIndex=startLen;
            }

            if(showIndex-startLen==1){//左侧如果间距是1则不需要"..."
                showIndex--;
            }

            if(rightNum==1){//右侧如果间距是1也不需要"..."
                showLen++;
            }

            html+='<li class="prev"><a href="javascript:;" aria-label="Previous"><span aria-hidden="true">«</span></a></li>';

            for(i=0;i<startLen;i++){//左侧开头
                html+='<li><a href="javascript:;">'+(i+1)+'</a></li>';
            }
            if(showIndex>startLen){//左边大于1的情况添加"..."
                html+='<li class="disabled"><a href="javascript:;">...</a></li>';
            }
            for(;showIndex<showLen;showIndex++){//中间部分
                html+='<li><a href="javascript:;">'+(showIndex+1)+'</a></li>';
            }
            if(rightNum>1){//右边大于1的情况添加"..."
                html+='<li class="disabled"><a href="javascript:;">...</a></li>';
            }
            for(i=opts.pageNum-end;i<opts.pageNum;i++){//右侧结尾
                html+='<li><a href="javascript:;">'+(i+1)+'</a></li>';
            }

            html+='<li class="next"><a href="javascript:;" aria-label="Next"><span aria-hidden="true">»</span></a></li>';
            container.html(html);

            container.children('li').filter(function(showIndex,item) {
                return $(item).children('a').text()==''+opts.curr;
            }).addClass('active');

            if(opts.curr<=1){
                container.find('.prev').addClass('disabled');
            }
            if(opts.curr==opts.pageNum){
                container.find('.next').addClass('disabled');
            }

            if(opts.callback){//绘制完，先运行一次callback
                opts.callback(opts.curr,opts.pageSize,opts.pageNum,opts.total);
            }
        }

        render();
        bindEvent();
    }

    var arr=[];
	for(var i=0;i<116;i++){
		arr.push({'title':'title'+(i+1)});
	}
	$('#page').doubanPage({
        pageSize:10,
        total:arr.length,
        curr:1,
        show:5,
        side:2,
		callback:function(curr,size,pages,total){
			var list=$('.list'), temp='',lis=list.children('li'),
				l=lis.length,k=0,
				w=list.outerWidth(),h=list.outerHeight();
			if(l>0){		
				var timerHide=setInterval(function(){
					$(lis[k]).animate({top: h+'px', left: w/2+'px',width:'0',height:'0'}, 100,
						function(){
						$(this).remove();
					});
					k++;
					if(k===l){
						clearInterval(timerHide);
						setTimeout(showList,200);
					}
				},100);
			}else{
				showList();
			}
			function showList(){
				var	i=(curr-1)*size,
					padding=10,per=130,
					c=0,r=0,j=0,posArr=[],pos;
				l=size*curr>total?total:size*curr;
				for(;i<l;i++){
					c=i%5;
					r=Math.floor(j/5);
					j++;
					posArr.push({top:(10+r*130),left:(10+c*130)});
					temp+='<li style="width:0;height:0;top:'+h+'px; left:'+w/2+'px;display:none;">'+arr[i].title+'</li>';
				}
				list.append(temp);
				lis=list.children('li');
				var timerShow=setInterval(function(){
					j--;
					pos=posArr.pop();
					$(lis[j]).show().animate({'top': pos.top+'px', 'left': pos.left+'px',
						width:'100px',height:'100px'}, 100);

					if(j<=0){
						clearInterval(timerShow);
					}
				},100);
			}
		}
	});
});
</script>
</head>
<body>
<div class="wrap">
	<ul class="list clearfix"></ul>
	<ul id="page" class="pagination"></ul>
</div>
</body>
</html>